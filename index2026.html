<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width">
    <title>ë¸íƒ€í•™ì› 2026 ìˆ˜ê°•ì‹ ì²­</title>
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://script.google.com/macros/s/AKfycbym8kDFqCa8zJUx-CwqK7eG2Qhc0TqMrP4mJ5zL872mSLFR91LIWZFATeKkOo5_xYbk/exec">
    <meta property="og:title" content="ë¸íƒ€ 2026 ìˆ˜ê°•ì‹ ì²­">
    <meta property="og:description" content="ë¸íƒ€í•™ì› 2026 ìˆ˜ê°•ì‹ ì²­ í˜ì´ì§€ì…ë‹ˆë‹¤.">
    <meta property="og:image" content="https://drive.google.com/uc?export=view&id=16wg0Q92khfUqQiXdio9KkZFPp1u-08S-">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">


    <style>
      *,
      *::before,
      *::after {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: "Noto Sans KR", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
        background-color: #f5f5f5;
        color: #333;
        line-height: 1.6;
        font-size: 16px;
      }

      .container {
        max-width: 980px;
        width: 95%;
        margin: 32px auto;
        padding: 28px;
        background: #000;
        border-radius: 12px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
        transition: box-shadow 0.3s ease;
      }

      .container:hover {
        box-shadow: 0 10px 35px rgba(0, 0, 0, 0.12);
      }

      header img {
        display: block;
        width: 100%;
        height: auto;
        border-radius: 8px;
        object-fit: contain;
        margin-bottom: 18px;
      }

      form, .lookupForm {
        width: 100%;
        padding: 10px;
        background: #fff;
        border-radius: 12px;
        border: 1px solid #eee;
        box-shadow: 0 2px 12px rgba(0, 0, 0, 0.05);
        margin-bottom: 20px;
      }

      .information, .course-cart {
        border: 2px solid #eee;
        border-radius: 10px;
        margin-bottom: 20px;
        background-color: #fafafa;
        padding: 15px 20px;
      }

      .information legend , .course-cart legend {
        font-weight: bold;
        font-size: 18px;
        color: #222;
        padding: 0 10px;
      }

      .info-box {
        background-color: #fff;
        border: 1px solid #fafafa;
        border-radius: 8px;
        padding: 15px 20px;
        line-height: 1.6;
      }

      .info-box ul {
        margin: 0;
        padding-left: 20px;
      }

      .info-box li {
        margin-bottom: 8px;
        list-style: 'ğŸ“Œ ';
        color: #333;
      }

      .info-box .contact {
        margin-top: 15px;
        font-weight: bold;
        color: #444;
        //text-align: center;
        line-height: 1.4;
      }

      

      label {
        display: block;
        margin-top: 10px;
        font-weight: 500;
        color: #222;
      }

      input, select, textarea {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid #d8d8d8;
        border-radius: 8px;
        font-size: 15px;
        background: #fff;
        display: block;
      }

      input:focus, select:focus, textarea:focus {
        border-color: #007bff;
        box-shadow: 0 0 5px rgba(0,123,255,0.25);
        outline: none;
      }

      .phone-input {
        width: 22%;
        min-width: 60px;
        display: inline-block;
        padding: 10px;
        margin: 6px 4px 6px 0;
        vertical-align: middle;
      }

      .short-input {
        width: auto;
        max-width: 40%;
        display: inline-block;
      }

      .wide-input {
        width: 100%;
      }

      .dash {
        margin: 0 2px;
        color: #888;
        font-size: 18px;
        font-weight: bold;
      }

      #helpNum {
        font-size: 14px;
        line-height: 1.5;
        border: 1px solid #ff5e00;
        background: #fff8f3;
        color: #333;
        border-radius: 8px;
        padding: 12px;
        margin-top: 15px;
      }

   

      button {
        border: none;
        border-radius: 8px;
        padding: 10px 14px;
        margin-bottom: 15px;
        background: #111;
        color: #fff;
        cursor: pointer;
        font-weight: 600;
        font-size: 15px;
        transition: background 0.2s ease;
      }

      input[type="submit"] {
        border: none;
        border-radius: 8px;
        padding: 15px 20px;
        margin-bottom: 15px;
        background: #111;
        color: #fff;
        cursor: pointer;
        font-weight: 600;
        font-size: 15px;
        transition: background 0.2s ease;
      }

      button:hover, input[type="submit"]:hover {
        background: #8C8C8C;
      }

      button + button {
        margin-left: 8px;
      }   

      .helpme-btn {
        background-color: #007bff;
        color: white;
        margin-top: 10px;
      }

      .check-Submit {
        background-color: #f39c12;
        color: white;
        margin-top: 10px;
        text-align: center;
      }

      .regist-btn {
        background-color: #e74c3c;
        color: white;
        font-size: 18px;
        padding: 15px 20px;
        margin-bottom: 10px;
        float: right;
      }

      .addCourse-btn {
        background-color: #007bff;
        color: white;
        margin-top: 10px;
        margin-bottom: 20px;
      }

      .course-cart-item {
        margin-left: 25px;
        font-weight: bold;
        color: #444;
        //text-align: center;
        line-height: 1.4;
      }

      .course-cart-item button {
        background-color: #FF1616;
        color: white;
        border: none;
        border-radius: 5px;
        padding: 5px 10px;
        cursor: pointer;
        margin-left: 20px;
        font-weight: bold;
      }

      .clear-cart-btn {
        background-color: #6c757d;
        color: white;
        //margin-left: 30px;
        float: right;
      }

      .search-btn {
        background-color: #3498db;
        color: white;
        margin-top: 10px;
      }

      .change-btn {
        background-color: #FF5E00;
        color: white;
        border: none;
        margin-top: 20px;
        padding: 10px 18px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 15px;
        transition: background-color 0.2s;
      }

      .primary-btn {
        background-color: #007bff;
        color: white;
      }

      .secondary-btn {
        background-color: #6c757d;
        color: white;
      }

      button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }

      .checkRegist {
        width: 100%;
        //max-width: 700px;
        margin: 30px auto;
        padding: 25px 30px;
        background: #fff;
        border-radius: 10px;
        border: 1px solid #eee;
        box-shadow: 0 4px 16px rgba(0,0,0,0.08);
        text-align: center;
      }

      .checkRegist-content {
        background: white;
        border-radius: 12px;
        width: 100%;
        margin: 0 auto;
        font-weight: bold;
      }

      .checkRegist-content h2 {
        font-size: 1.6rem;
        color: #222;
        text-align: center;
        margin-bottom: 10px;
      }

      #submit-message {
        font-size: 1.1rem;
        margin-top: 10px;
        margin-bottom: 20px;
        color: #555;
        text-align: center;
      }

      .checkGrid {
        display: grid;
        grid-template-columns: 140px 1fr;
        gap: 10px 15px;
        margin-top: 20px;
        width: 100%;
        align-items: center;
      }

      .checkGrid label {
        text-align: right;
        justify-content: flex-end;
        color: #444;
        font-weight: 600;
        line-height: 1.4;
      }

      .checkGrid .value {
        text-align: left;
        justify-content: flex-start;
        color: #111;
        font-weight: 500;
        white-space: pre-wrap;
        word-break: break-word;
        line-height: 1.4;
      }

      #checkLecture {
        display: flex;
        flex-direction: column;
        align-items: flex-start !important;
        text-align: left !important;
        gap: 4px;
        width: 100%;
      }



      .lookupForm-content {
        position: relative;
        background-color: #fff;
        padding: 25px 30px;
        border-radius: 12px;
        width: 100%;
        //margin: 10px auto;
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      

      .lookupForm-content h2 {
        text-align: center;
        margin-top: 10px;
        margin-bottom: 30px;
      }

      .close-btn {
        position: absolute;
        top: 15px;
        right: 15px;
        background: none;
        border: none;
        color: #666;
        font-size: 14px;
        font-weight: bold;
        cursor: pointer;
        transition: color 0.3s;
      }


      .lookup-grid {
        display: grid;
        grid-template-columns: 120px 1fr;
        gap: 25px 20px; /* í–‰ ê°„ê²©, ì—´ ê°„ê²© */
        align-items: center;
        justify-content: center;
        //margin: 25px auto;
      }

      .lookup-grid label {
        font-weight: 600;
        text-align: right;
        color: #333;
      }

      .lookup-grid input,
      .lookup-grid select {
        width: 22%;
        padding: 8px 10px;
        border: 1px solid #ccc;
        border-radius: 6px;
        font-size: 14px;
      }

      .phone-group {
        width: 100%;
        text-align: left;
      }

      .search-btn {
        display: block;
        margin: 25px auto 10px;
        background-color: #0078d7;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 8px;
        font-size: 15px;
        cursor: pointer;
        transition: background-color 0.2s;
      }





      #lookupResults {
        margin-top: 15px;
        line-height: 1.6;
        font-weight: bold;
        font-size: 1.2rem;
      }

      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-15px); }
        to { opacity: 1; transform: translateY(0); }
      }


      .close {
        float: right;
        font-weight: bold;
        font-size: 18px;
        cursor: pointer;
        color: #555;
      }

      //.close:hover { color: #000; }


      .loading-spinner {
        border: 20px solid #f3f3f3;
        border-top: 20px solid #3498db;
        border-radius: 50%;
        width: 100px;
        height: 100px;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% { transform: rotate(0); }
        100% { transform: rotate(360deg); }
      }

      .loading-text {
        font-size: 20px;
        font-weight: bold;
        color: #007bff;
      }

      img {
        max-width: 100%;
        height: auto;
        display: block;
      }

      #overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 8888;
        display: none;
      }

      #loading {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background-color: rgba(255, 255, 255, 0.5);
        z-index: 1000;
      }

      #selection, #access-popup {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: #ffffff;
        padding: 24px 32px;
        border-radius: 12px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        display: flex;
        flex-direction: column; /* ì„¸ë¡œ ì •ë ¬ */
        justify-content: center;
        align-items: center;
        text-align: center;
        gap: 15px;
        border: 1px solid #e0e0e0;
        z-index: 9999;
        width: auto;
        min-width: 300px;
        max-width: 90%;
      }


      #selection p, #popup-message {
        font-size: 1.1rem;
        font-weight: bold;
        color: #333;
      }

      #time-remaining {
        font-size: 1.1rem;
        font-weight: bold;
        color: red;
      }

      #selection button, #access-popup button {
        background-color: #007bff;
        color: #fff;
        border: none;
        border-radius: 8px;
        padding: 5px 10px;
        cursor: pointer;
        font-size: 1rem;
        transition: background-color 0.2s ease;
      }




      @media (max-width: 992px) {
        .container {
          padding: 16px;
          margin: 18px auto; 
        }

        form {
          width: 100%;
          padding: 15px;
        }

        .lookupForm {
          width: 100%;
          align-items: center;
        }

        .lookupForm-content h2, .checkRegist-content h2 {
          margin: 70px 50px auto;
          padding: 15px;
          font-size : 70px;
        }

        label, input, select, textarea, button, .check-Submit, .information legend ,
        .course-cart legend, .dash, .lookup-grid label, #submit-message {
          font-weight: bold;
          font-size: 50px;
        }

        
        .close-btn, #duplicateCourses, .waitingList {
          font-weight: bold;
          font-size: 35px;
        }

        .course-cart-item {
          font-weight: bold;
          font-size: 40px;
        }

        .clear-cart-btn {
          font-size: 30px;
          align-items: right;
          float: right;
        }

        .info-box, #helpNum {
          font-size: 35px;
          margin-bottom: 15px;
        }

        .lookup-grid, .checkGrid {
          display: grid;
          grid-template-columns: 300px 600px;
          gap: 5px 10px; /* í–‰ ê°„ê²©, ì—´ ê°„ê²© */
          align-items: center;
          justify-content: center;
          //margin-bottom: 30px;
          font-weight: bold;
        }

        .lookup-grid input, .lookup-grid select, .checkGrid label, .checkGrid .value {
          width: 100%;
          font-size: 50px;
        }

        #lookupResults {
          font-size: 50px;
          width: 90%;
          text-align: center;
          align-items: center;
          margin-bottom: 20px;
        }

        .phone-group {
          display: flex;
          align-items: center;
          gap: 5px;
          width: 88%;
        }

        .phone-input {
          width: 30%;
          text-align: center;
        }


        .short-input {
          max-width: 100%;
          display: block;
        }



        //ìˆ˜ê°•ì‹ ì²­ í•˜ëŸ¬ ê°€ê¸°, ì‹ ì²­í•˜ê¸° ë²„íŠ¼
        .regist-btn, input[type="submit"] {
          width: 100%;
          float: none;
          margin-top: 20px;
          padding-top: 15px;
          padding-bottom: 15px;
          font-size: 55px;
          font-weight: bold;
          align-items: center;
        }

        .search-btn, .change-btn {
          width: 50%;
          font-size: 50px;
          margin-top: 15px;
        }

        .secondary-btn, .primary-btn {
          width: 80%;
          font-size: 45px;
          margin-top: 20px;
        }

        .loading-spinner {
          border: 20px solid #f3f3f3;
          border-top: 20px solid #3498db;
          border-radius: 50%;
          width: 100px;
          height: 100px;
          animation: spin 1s linear infinite;
        }

        @keyframes spin {
          0% { transform: rotate(0); }
          100% { transform: rotate(360deg); }
        }

        .loading-text {
          font-size: 45px;
          font-weight: bold;
          color: #007bff;
        }

        #selection {
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          
          width: auto;
          height: auto;
          max-width: 70vw;
          max-height: 30vh;
          background-color: #fff;
          padding: 25px;
          border-radius: 12px;
          border: 3px solid black;

          display: flex;
          flex-direction: column;         /* ì„¸ë¡œ ë°©í–¥ ì •ë ¬ */
          justify-content: center;        /* ì„¸ë¡œ ì¤‘ì•™ ì •ë ¬ */
          align-items: center;            /* ê°€ë¡œ ì¤‘ì•™ ì •ë ¬ */
          text-align: center;
          gap: 10px;                      /* ìš”ì†Œ ê°„ ê°„ê²© */
        }

        #access-popup {
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);

          width: auto;
          height: auto;
          max-width: 70vw;
          max-height: 30vh;

          background-color: #fff;
          padding: 20px;
          border-radius: 12px;
          border: 2px solid black;

          display: flex;
          flex-direction: column;
          justify-content: center;        /* ì„¸ë¡œ ì¤‘ì•™ ì •ë ¬ */
          align-items: center;            /* ê°€ë¡œ ì¤‘ì•™ ì •ë ¬ */
          text-align: center;
          gap: 20px;
        }

        #selection h2 {
          font-size: 50px;
          font-weight: bold;
          color: black;
        }

        #selection p {
          font-size: 40px;
          font-weight: bold;
          color: #333;
        }

        #popup-message {
          font-size: 40px;
          font-weight: bold;
          color: #333;
          margin-top: 35px;
        }


        #time-remaining {
          font-size: 40px;
          font-weight: bold;
          color: red;
          margin-bottom: 35px;
        }

        #selection button {
          background-color: #007bff;
          color: #fff;
          border: none;
          border-radius: 8px;
          padding: 20px 20px;
          margin-bottom: 20px;
          cursor: pointer;
          font-size: 45px;
          transition: background-color 0.2s ease;
          width: 30%;
        }

        #access-popup button {
          background-color: #007bff;
          color: #fff;
          border: none;
          border-radius: 8px;
          padding: 20px 20px;
          cursor: pointer;
          font-size: 45px;
          transition: background-color 0.2s ease;
          width: 80%;
        }


      }
    </style>

    <script>
        function handlePhoneInput(currentField, nextFieldId) {
          currentField.value = currentField.value.replace(/[^0-9]/g, '');
          if (currentField.value.length > currentField.maxLength) {
            currentField.value = currentField.value.slice(0, currentField.maxLength);
          }
          if (currentField.value.length === currentField.maxLength && nextFieldId) {
            const nextField = document.getElementById(nextFieldId);
            if (nextField) nextField.focus();
          }
        }

        function getFullPhone(idPrefix) {
          const part1 = document.getElementById(idPrefix + "1").value.trim();
          const part2 = document.getElementById(idPrefix + "2").value.trim();
          const part3 = document.getElementById(idPrefix + "3").value.trim();
          return `${part1}-${part2}-${part3}`;
        }

        let selectedCourses = [];
        let isResubmission = false;

        let subjectsCache = {};
        let lecturesCache = {};
        let isPopupClosed = false;

        document.addEventListener("DOMContentLoaded", function () {

          showAccessPopup();

          document.body.addEventListener("click", function (event) {
            const popup = document.getElementById("access-popup");
            const overlay = document.getElementById("overlay");

            if (isPopupClosed && event.target.id !== "access-popup" && !popup.contains(event.target) && event.target.id !== "overlay") {
              showAccessPopup();
              isPopupClosed = false;
            }
          });
        });

        function showAccessPopup() {
          const overlay = document.getElementById("overlay");
          const popup = document.getElementById("access-popup");
          const timeRemaining = document.getElementById("time-remaining");
          const informForm = document.getElementById("informForm");
          const submitForm = document.getElementById("registrationForm");

          const now = new Date();
          const limitDate = new Date('2024-11-20T14:00:00'); // ì‹œê°„ ì œí•œ

          const remainingTime = limitDate - now;

          if (remainingTime > 0) {
            const minutes = Math.floor((remainingTime / 1000 / 60) % 60);
            const hours = Math.floor(remainingTime / 1000 / 60 / 60);

            document.getElementById("popup-message").innerText = "ìˆ˜ê°•ì‹ ì²­ì€ 11ì›” 20ì¼(ëª©) ì˜¤í›„ 2ì‹œ ì´í›„ë¶€í„° ê°€ëŠ¥í•©ë‹ˆë‹¤.";
            timeRemaining.innerText = `ë‚¨ì€ ì‹œê°„ : ${hours}ì‹œê°„ ${minutes}ë¶„`;

            setInterval(function () {
              const now = new Date();
              if (now < limitDate) {
                const remainingTime = limitDate - now;
                const hours = Math.floor(remainingTime / 1000 / 60 / 60);
                const minutes = Math.floor((remainingTime / 1000 / 60) % 60);
                timeRemaining.innerText = `ë‚¨ì€ ì‹œê°„ : ${hours}ì‹œê°„ ${minutes}ë¶„`;
              }
            }, 1000);

            overlay.style.display = "block";
            popup.style.display = "block";
            informForm.style.display = "none";
            submitForm.style.display = "none";
          } else {
            overlay.style.display = "none";
            popup.style.display = "none";
            informForm.style.display = "block";
          }
        }


        function closeAccessPopup() {
          console.log("ë‹«ê¸° ë²„íŠ¼ í´ë¦­ë¨"); // ë²„íŠ¼ í´ë¦­ì‹œ ì½˜ì†”ì— ë©”ì‹œì§€ ì¶œë ¥
          const overlay = document.getElementById("overlay");
          const popup = document.getElementById("access-popup");
          overlay.style.display = "none";
          popup.style.display = "none";

          isPopupClosed = true;
        }

        function redirectToHome() {
          const targetUrl = "https://www.xn--bo1bw08abihswe.kr/";
          window.open(targetUrl, "_blank");
        }

        function helpmePlease() {
          const targetUrl = "https://www.xn--bo1bw08abihswe.kr/advice/advice.php";
          window.open(targetUrl, "_blank");
        }

        function openlookupForm() {
          document.getElementById('informForm').style.display = 'none';
          document.getElementById('registrationForm').style.display = 'none';
          document.getElementById('checkRegist').style.display = 'none';
          document.getElementById('lookupForm').style.display = 'flex';
          document.getElementById("lookupResults").innerHTML = "";
        }


        function closelookupForm() {
          document.getElementById('informForm').style.display = 'block';
          document.getElementById('registrationForm').style.display = 'none';
          document.getElementById('checkRegist').style.display = 'none';
          document.getElementById('lookupForm').style.display = 'none';
          document.getElementById("lookupResults").innerHTML = "";
          document.getElementById('lookupForm').reset();
        }

        
        function registLecture() {
          document.getElementById('informForm').style.display = 'block';
          document.getElementById('registrationForm').style.display = 'block';
        }

        //ì‹ ì²­ë‚´ì—­ ì¡°íšŒí•˜ëŠ” í•¨ìˆ˜
        function fetchSubmissionData() {
          const name = document.getElementById("lookupName").value.trim();
          const grade = document.getElementById("lookupGrade").value;
          const parentContact = getFullPhone("lookupParentContact");

          if (!name.length || !grade.length || !parentContact.length) {
            document.getElementById("lookupResults").innerHTML = "<p style='color: red;'>â€»ëª¨ë“  í•­ëª©ì„ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>";
            return;
          }
          
          showLoading();

          google.script.run.withSuccessHandler(function(results) {
            hideLoading();
            const container = document.getElementById("lookupResults");
            const changeBtn = document.getElementById("change-btn");

            if (!results || results.length === 0) {
              container.innerHTML = "<p>ì¡°íšŒëœ ìˆ˜ê°•ì‹ ì²­ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</p>";
              changeBtn.style.display = "none";
            } else {
              let html = "<ul>";
              results.forEach(course => {
                html += `<li>${course}</li>`;
              });
              html += "</ul>";
              container.innerHTML = html;
              
              changeBtn.style.display = "inline-block";
              changeBtn.onclick = function() {
                loadPreviousApplication(name, grade, parentContact);
              };

            }
          }).getSubmittedCourses(name, grade, parentContact);
        }


        function loadPreviousApplication(name, grade, parentContact) {
          document.getElementById('informForm').style.display = 'none';
          document.getElementById("registrationForm").style.display = 'block';
          document.getElementById('checkRegist').style.display = 'none';
          document.getElementById('lookupForm').style.display = 'none';
          document.getElementById('checkRegist').reset();

          showLoading();

          google.script.run.withSuccessHandler(function(data) {
            if (!data) {
              hideLoading();
              selectionPopup("ğŸ“¢ ì•Œë¦¼", "ì‹ ì²­ë‚´ì—­ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ì •ë³´ë¥¼ ë‹¤ì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”.");
              return;
            }

            isResubmission = true;
            document.getElementById('name').value = data.name;
            document.getElementById('grade').value = data.grade;
            document.getElementById('school').value = data.school;

            const sParts = data.studentContact.split('-');
            const pParts = data.parentContact.split('-');
            document.getElementById('studentContact1').value = sParts[0];
            document.getElementById('studentContact2').value = sParts[1];
            document.getElementById('studentContact3').value = sParts[2];
            document.getElementById('parentContact1').value = pParts[0];
            document.getElementById('parentContact2').value = pParts[1];
            document.getElementById('parentContact3').value = pParts[2];

            fetchSubjects();

            setTimeout(() => {
              if (data.courses && data.courses.length > 0) {
                fetchLectures();
              }

              selectedCourses = data.courses;
              updateCart();
              hideLoading();
              selectionPopup("ğŸ“¢ ì•Œë¦¼", "ì‹ ì²­ë‚´ì—­ì´ ìë™ìœ¼ë¡œ ì…ë ¥ë˜ì—ˆìŠµë‹ˆë‹¤. ë³€ê²½ í›„ ë‹¤ì‹œ ì‹ ì²­í•´ì£¼ì„¸ìš”. ë³€ê²½ì‹œ ê¸°ì¡´ ì‹ ì²­ë‚´ì—­ì€ ì·¨ì†Œë©ë‹ˆë‹¤.");
            }, 600);
          }).getStudentApplication(name, grade, parentContact);
        }

        function goToHome() {
          document.getElementById('informForm').style.display = 'block';
          document.getElementById("registrationForm").style.display = 'none';
          document.getElementById('checkRegist').style.display = 'none';
          document.getElementById('lookupForm').style.display = 'none';
          document.getElementById("registrationForm").reset();

          selectedCourses = [];
          updateCart();
          lecturesCache = {};
          isResubmission = false;

          const subjectSelect = document.getElementById("subject");
          const lectureSelect = document.getElementById("lecture");
          if (subjectSelect) subjectSelect.innerHTML = "<option value=''>ì„ íƒ</option>";
          if (lectureSelect) lectureSelect.innerHTML = "<option value=''>ì„ íƒ</option>";

          document.getElementById("submit-message").innerText = "";
        }

        function goToAddMore() {
          document.getElementById('informForm').style.display = 'block';
          document.getElementById("registrationForm").style.display = 'block';
          document.getElementById('checkRegist').style.display = 'none';
          document.getElementById('lookupForm').style.display = 'none';

          selectedCourses = [];
          updateCart();
          lecturesCache = {};
          isResubmission = false;

          const subjectSelect = document.getElementById("subject");
          const lectureSelect = document.getElementById("lecture");
          if (subjectSelect) subjectSelect.innerHTML = "<option value=''>ì„ íƒ</option>";
          if (lectureSelect) lectureSelect.innerHTML = "<option value=''>ì„ íƒ</option>";

          const grade = document.getElementById("grade").value;
          if (grade) {
            showLoading();
            google.script.run.withSuccessHandler(subjects => {
              
              if (subjects && subjects.length > 0) {
                subjects.forEach(subj => {
                  const option = document.createElement("option");
                  option.value = subj;
                  option.textContent = subj;
                  subjectSelect.appendChild(option);
                });
              } else {
                selectionPopup("ğŸ“¢ ì•Œë¦¼", "í•´ë‹¹ í•™ë…„ì— ë“±ë¡ëœ ê³¼ëª©ì´ ì—†ìŠµë‹ˆë‹¤.");
              }
              hideLoading();
            }).getSubjects(grade);
          } else {
            selectionPopup("ğŸ“¢ ì•Œë¦¼", "í•™ë…„ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì„ íƒí•´ì£¼ì„¸ìš”.");
          }

          setTimeout(() => {
            selectionPopup("ğŸ“¢ ì•Œë¦¼", "ì¶”ê°€ì‹ ì²­ì„ ìœ„í•´ ê³¼ëª©ê³¼ ê°•ì˜ë¥¼ ìƒˆë¡œ ì„ íƒí•´ì£¼ì„¸ìš”.");
          }, 800);
        }



        function fetchSubjects() {
          const grade = document.getElementById('grade').value;

          showLoading();

          if (subjectsCache[grade]) {
            setTimeout(() => {
              updateSubjects(subjectsCache[grade]);
              hideLoading();
            }, 500);
          } else {
            google.script.run.withSuccessHandler((subjects) => {
              subjectsCache[grade] = subjects;
              updateSubjects(subjects);
              hideLoading();
            }).getSubjects(grade);
          }
        }

        function fetchLectures() {
          const grade = document.getElementById('grade').value;
          const subject = document.getElementById('subject').value;

          showLoading();

          google.script.run.withSuccessHandler((lectures) => {
            if (!lecturesCache[grade]) {
              lecturesCache[grade] = {};
            }
            lecturesCache[grade][subject] = lectures;
            updateLectures(lectures);
          }).getLectures(grade, subject);
          
          hideLoading();
        }

        function updateSubjects(subjects) {
          const subjectSelect = document.getElementById('subject');
          subjectSelect.innerHTML = '';
          subjects.forEach(subject => {
            const option = document.createElement('option');
            option.value = subject;
            option.textContent = subject;
            subjectSelect.appendChild(option);
          });
          fetchLectures();
        }

        function updateLectures(lectures) {
          const lectureSelect = document.getElementById('lecture');
          lectureSelect.innerHTML = '';
          lectures.forEach(lecture => {
            const option = document.createElement('option');
            option.value = lecture.name;
            option.textContent = lecture.name;

            if (lecture.closed) {
              option.disabled = true;
            }

            lectureSelect.appendChild(option);
          });
        }

        function addCourse() {
          const subject = document.getElementById("subject").value;
          const lecture = document.getElementById('lecture').value;

          if (!subject || subject === "ì„ íƒ" || !lecture || lecture === "ì„ íƒ") {
            selectionPopup("ğŸ“¢ ì•Œë¦¼", "ê³¼ëª©ê³¼ ê°•ì˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");
            return;
          }
          
          if (!lecture) {
            selectionPopup("ğŸ“¢ ì•Œë¦¼", "ê°•ì¢Œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");
            return;
          }
          if (lecture.includes("[ë§ˆê°]")) {
            selectionPopup("â—â— ë§ˆê°ëœ ê°•ì¢Œ", "ì´ë¯¸ ë§ˆê°ëœ ê°•ì¢Œì´ë©°, ëŒ€ê¸°ì‹ ì²­ìœ¼ë¡œ ì§„í–‰ë©ë‹ˆë‹¤.");
          }
          if (lecture.includes("(Test)")) {
            selectionPopup("ğŸ“ ì…ë°˜í…ŒìŠ¤íŠ¸", "í•´ë‹¹ ê°•ì¢ŒëŠ” ì…ë°˜ í…ŒìŠ¤íŠ¸ê°€ ìˆìŠµë‹ˆë‹¤. í…ŒìŠ¤íŠ¸ ì¼ì •ì€ ì¶”í›„ ì•ˆë‚´ ë“œë¦´ ì˜ˆì •ì…ë‹ˆë‹¤.");
          }
          if (selectedCourses.includes(lecture)) {
            selectionPopup("ğŸ“¢ ì•Œë¦¼", "ì´ë¯¸ ì¶”ê°€ëœ ê°•ì¢Œì…ë‹ˆë‹¤.");
            return;
          }
          selectedCourses.push(lecture);
          updateCart();
          
          
        }

        function updateCart() {
          const cart = document.getElementById("cart");
          cart.innerHTML = "";
          selectedCourses.forEach((course, index) => {
            const listItem = document.createElement("li");
            listItem.classList.add('course-cart-item');
            const courseName = document.createElement('span');
            courseName.textContent = course;
            const removeButton = document.createElement('button');
            removeButton.textContent = 'X';
            removeButton.onclick = () => removeCourse(index);
            listItem.appendChild(courseName);
            listItem.appendChild(removeButton);
            cart.appendChild(listItem);
          });
        }

        function clearCart() {
          selectedCourses = [];
          updateCart();
        }

        function removeCourse(index) {
          selectedCourses.splice(index, 1);
          updateCart();
        }

        function onSubmit(event) {
          if (event && typeof event.preventDefault === "function") event.preventDefault();

          const name = document.getElementById("name").value.trim();
          const grade = document.getElementById("grade").value.trim();
          const school = document.getElementById("school").value.trim();
          const studentContact = getFullPhone("studentContact");
          const parentContact = getFullPhone("parentContact");

          if (!name || !grade || !school || !studentContact || !parentContact) {
            selectionPopup("ğŸ“¢ ì•Œë¦¼", "ëª¨ë“  ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            return;
          }
          if (!Array.isArray(selectedCourses) || selectedCourses.length === 0) {
            selectionPopup("ğŸ“¢ ì•Œë¦¼", "ì‹ ì²­í•  ê°•ì¢Œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");
            return;
          }

          showLoading();

          google.script.run
            .withSuccessHandler(onSuccess)
            .withFailureHandler(function(err){
              hideLoading();
              onError(err);
            })
            .submitForm(name, grade, school, studentContact, parentContact, selectedCourses, isResubmission.toString());
        }

        function selectionPopup(title, message) {
          const plzSelect = document.getElementById("selection");
          document.getElementById("selection-title").innerText = title;
          document.getElementById("plzSelect-popup").innerText = message;
          plzSelect.style.display = "flex";
        }

        function closeSelect() {
          const plzSelect = document.getElementById("selection");
          plzSelect.style.display = "none";
        }

        function onSuccess(responseObj) {
          try { console.log("submitForm response:", responseObj); } catch(e){}

          if (!responseObj || typeof responseObj !== "object") {
            hideLoading();
            selectionPopup("âš  ê²½ê³ ", "ì„œë²„ ì‘ë‹µì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
            return;
          }

          const {
            message = "",
            previousCourses = [],
            addedCourses = [],
            duplicateCourses = [],
            waitingList = {}
          } = responseObj;

          const name = (document.getElementById("name")?.value || "").trim();
          const grade = (document.getElementById("grade")?.value || "").trim();
          const school = (document.getElementById("school")?.value || "").trim();
          const studentContact = typeof getFullPhone === "function" ? getFullPhone("studentContact") : "";
          const parentContact = typeof getFullPhone === "function" ? getFullPhone("parentContact") : "";

          const newCoursesDiv = document.getElementById("newCourses");
          const prevCoursesDiv = document.getElementById("previousCourses");
          const dupEl = document.getElementById("duplicateCourses");

          document.getElementById("submit-message").innerText = message;
          document.getElementById("checkName").innerText = name;
          document.getElementById("checkGrade").innerText = `${school} / ${grade}`;
          document.getElementById("checkStudentContact").innerText = studentContact;
          document.getElementById("checkParentContact").innerText = parentContact;

          newCoursesDiv.innerHTML = "";
          prevCoursesDiv.innerHTML = "";

          if (Array.isArray(duplicateCourses) && duplicateCourses.length > 0) {
            if (dupEl) {
              dupEl.innerText = "âš ï¸ ì¤‘ë³µëœ ê°•ì¢Œ: " + duplicateCourses.join(", ");
              dupEl.style.display = "block";
            } else {
              console.warn("duplicateCourses present but #duplicateCourses element not found");
            }
          } else if (dupEl) {
            dupEl.style.display = "none";
            dupEl.innerText = "";
          }

          let waitingEl = document.getElementById("waitingList");
          if (!waitingEl) {
            const container = document.querySelector("#checkRegist .checkRegist-content");
            if (container) {
              waitingEl = document.createElement("div");
              waitingEl.id = "waitingList";
              waitingEl.style.display = "none";
              waitingEl.style.color = "#d9534f";
              waitingEl.style.fontWeight = "600";
              waitingEl.style.margin = "6px 0 12px 0";
              container.insertBefore(waitingEl, container.querySelector(".checkGrid"));
            }
          }

          if (waitingEl) {
            const waitKeys = Object.keys(waitingList || {});
            if (waitKeys.length > 0) {
              const parts = waitKeys.map(k => `${k} (ëŒ€ê¸°:${waitingList[k]}ë²ˆ)`);
              waitingEl.innerText = "â³ ëŒ€ê¸°ì‹ ì²­: " + parts.join(", ");
              waitingEl.style.display = "block";
            } else {
              waitingEl.style.display = "none";
              waitingEl.innerText = "";
            }
          }

          const added = Array.isArray(addedCourses) ? addedCourses : (addedCourses ? [String(addedCourses)] : []);
          if (added.length > 0) {
            added.forEach(function(course) {
              const div = document.createElement("div");
              div.textContent = `â€¢ ${course}`;
              newCoursesDiv.appendChild(div);
            });
            document.getElementById("newCoursesTitle").style.display = "block";
          } else {
            document.getElementById("newCoursesTitle").style.display = "none";
          }

          const prevArr = Array.isArray(previousCourses) ? previousCourses : (previousCourses ? [String(previousCourses)] : []);
          const dedupPrev = Array.from(new Set(prevArr.filter(Boolean)));
          if (dedupPrev.length > 0) {
            dedupPrev.forEach(function(course) {
              const div = document.createElement("div");
              div.textContent = `â€¢ ${course}`;
              prevCoursesDiv.appendChild(div);
            });
            document.getElementById("previousCoursesTitle").style.display = "block";
          } else {
            document.getElementById("previousCoursesTitle").style.display = "none";
          }

          document.getElementById("informForm").style.display = "none";
          document.getElementById("registrationForm").style.display = "none";
          document.getElementById("checkRegist").style.display = "block";

          hideLoading();

          selectedCourses = [];
          updateCart();
          lecturesCache = {};
          isResubmission = false;
        }

        function onError(error) {
          hideLoading();
          console.error("ì‹ ì²­ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", error);
          selectionPopup("âš  ê²½ê³ ", "ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");
        }



        function moveToNext(current, nextFieldId) {
          current.value = current.value.replace(/[^0-9]/g, ''); // ìˆ«ì ì´ì™¸ì˜ ë¬¸ì ì œê±°

          if (current.value.length > current.maxLength) {
            current.value = current.value.slice(0, current.maxLength);
          }

          if (current.value.length === current.maxLength && nextFieldId) {
            document.getElementById(nextFieldId).focus();
          }
        }

        function showLoading() {
          document.getElementById("loading").style.display = "flex";
        }

        function hideLoading() {
          document.getElementById("loading").style.display = "none";
        }

      </script>
      <script>
        document.addEventListener("DOMContentLoaded", function () {
          document.getElementById("popup").style.display = "none";
          document.getElementById("selection").style.display = "none";
        });
      </script>
  </head>

  <body>
      <div id="overlay" class="overlay"></div>
      <div id="access-popup" class="popup">   
        <p id="popup-message"></p>
        <p id="time-remaining"></p>
        <button type="button" onclick="redirectToHome()">ë¸íƒ€í•™ì› í™ˆí˜ì´ì§€ë¡œ ì´ë™</button>
        <button type="button" onclick="closeAccessPopup()">ë‹«ê¸°</button>
      </div>

      <div class="container" id="main-content">
        <header>
          <img src="https://lh3.googleusercontent.com/d/1r4RWcQvYDx_WS37hY1UZIyzIDICMJhdP?authuser=0" alt="ë¡œê³ " style="width: 100%; height: auto; margin: 10px auto; display: block;"/>
        </header>

        <form id="informForm" class="informForm">
          <fieldset class="information">
            <legend>ğŸ“‹ ìˆ˜ê°•ì‹ ì²­ ë°©ë²• ì•ˆë‚´</legend>
            <div class="info-box">
              <ul>
                <li>ë‹¤ê³¼ëª© ì‹ ì²­ì˜ ê²½ìš°, ê³¼ëª©/ê°•ì˜ë¥¼ ì—¬ëŸ¬ ë²ˆ ì¶”ê°€í•˜ì—¬ ì¼ê´„ ì‹ ì²­ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</li>
                <li>ë§ˆê°ëœ ê°•ì¢ŒëŠ” ì‹ ì²­ì´ ë¶ˆê°€í•˜ë©°, ëŒ€ê¸° í¬ë§ ì‹œ í•™ì›ìœ¼ë¡œ ë¬¸ì˜ ë¶€íƒë“œë¦½ë‹ˆë‹¤.</li>
                <!-- <li>ì‹ ì²­í•˜ê¸° ì™„ë£Œ í›„ ë³„ë„ íŒì—…ì´ ëœ¨ë©´ ì‹ ì²­ì´ ì™„ë£Œëœ ê²ƒì´ë©°, 
                  ìˆ˜ê°•ì‹ ì²­ ë‚´ì—­ì€ í™•ì¸ í›„ 1~2ì¼ ë‚´ ë¬¸ìë¡œ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.</li> -->
                <li>ìˆ˜ê°•ì‹ ì²­ì— ì–´ë ¤ì›€ì´ ìˆìœ¼ì‹  ê²½ìš° ì „í™”ë¡œë„ ì‹ ì²­ ê°€ëŠ¥í•©ë‹ˆë‹¤.</li>
              </ul>
              
              <p class="contact">ğŸ“ 053-782-5050<br>
                <small>í‰ì¼ ì˜¤í›„ 2ì‹œ ~ ì˜¤í›„ 10ì‹œ<br>ì£¼ë§ ì˜¤ì „ 9ì‹œ ~ ì˜¤í›„ 9ì‹œ</small>
              </p>
            </div>
          </fieldset>

          <div id="helpmePlz">
            <label for="helpme">ğŸ“Œ ìˆ˜ê°• ê³¼ëª© ì„ íƒì´ ì–´ë ¤ìš°ì‹¤ ê²½ìš°, ìƒë‹´ ì‹ ì²­ ì ‘ìˆ˜ í•´ì£¼ì‹œë©´ ì—°ë½ ë“œë ¤ì„œ ë„ì›€ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</label>
            <button type="button" onclick="helpmePlease()" class="helpme-btn">ìƒë‹´ ì‹ ì²­ ë°”ë¡œê°€ê¸°</button><br>
            <button type="button" onclick="openlookupForm()" class="check-Submit">ìˆ˜ê°•ì‹ ì²­ë‚´ì—­ í™•ì¸ ë° ë³€ê²½</button>
            <button type="button" onclick="registLecture()" class="regist-btn">ìˆ˜ê°•ì‹ ì²­ í•˜ëŸ¬ ê°€ê¸°</button>
          </div>
        </form>


        <form id="registrationForm" onsubmit="onSubmit(event); return false;" style="display: none;">
          <label for="name">í•™ìƒëª…</label>
          <input type="text" id="name" name="name" required class="short-input" placeholder="ê¹€ë¸íƒ€"><br>

          <label for="school">í•™êµ</label>
          <input type="text" id="school" name="school" required class="short-input" placeholder="ë¸íƒ€ì¤‘/ë¸íƒ€ê³ "><br>

          <label for="grade">í•™ë…„</label>
          <select id="grade" name="grade" required class="short-input" onchange="fetchSubjects()">
            <option value="">ì„ íƒ</option>
            <option value="ì´ˆ6">ì˜ˆë¹„ì´ˆ6</option>
            <option value="ì¤‘1">ì˜ˆë¹„ì¤‘1</option>
            <option value="ì¤‘2">ì˜ˆë¹„ì¤‘2</option>
            <option value="ì¤‘3">ì˜ˆë¹„ì¤‘3</option>
            <option value="ê³ 1">ì˜ˆë¹„ê³ 1</option>
            <option value="ê³ 2">ì˜ˆë¹„ê³ 2</option>
            <option value="ê³ 3">ì˜ˆë¹„ê³ 3&Nìˆ˜</option>
            <option value="ì¼ê³¼ê³ ">ì¼ê³¼ê³ </option>
          </select><br>

          <label id="helpNum" for="helpNum">â€» ì—°ë½ì²˜ë¥¼ ì œëŒ€ë¡œ ì…ë ¥í•˜ì§€ ì•Šìœ¼ë©´ ìˆ˜ê°•ì‹ ì²­ í™•ì¸ì´ ë¶ˆê°€í•˜ë‹ˆ, ì •í™•í•˜ê²Œ ì…ë ¥ ë¶€íƒ ë“œë¦½ë‹ˆë‹¤.<br>â€» í•™ìƒ ì—°ë½ì²˜ê°€ ì—†ì„ ê²½ìš°, í•™ë¶€ëª¨ë‹˜ ì—°ë½ì²˜ì™€ ë™ì¼í•˜ê²Œ ì…ë ¥ ë¶€íƒ ë“œë¦½ë‹ˆë‹¤.</label>

          <label for="studentContact">í•™ìƒ ì—°ë½ì²˜</label>
          <input type="text" id="studentContact1" name="studentContact1" maxlength="3" required class="phone-input" placeholder="010"
                oninput="handlePhoneInput(this,'studentContact2')">
          <span class="dash">-</span>
          <input type="text" id="studentContact2" name="studentContact2" maxlength="4" required class="phone-input" placeholder="1234"
                oninput="handlePhoneInput(this,'studentContact3')">
          <span class="dash">-</span>
          <input type="text" id="studentContact3" name="studentContact3" maxlength="4" required class="phone-input" placeholder="5678"
                oninput="handlePhoneInput(this,'parentContact1')">
          <br>

          <label for="parentContact">í•™ë¶€ëª¨ ì—°ë½ì²˜</label>
          <input type="text" id="parentContact1" name="parentContact1" maxlength="3" required class="phone-input" placeholder="010"
                oninput="handlePhoneInput(this,'parentContact2')">
          <span class="dash">-</span>
          <input type="text" id="parentContact2" name="parentContact2" maxlength="4" required class="phone-input" placeholder="1234"
                oninput="handlePhoneInput(this,'parentContact3')">
          <span class="dash">-</span>
          <input type="text" id="parentContact3" name="parentContact3" maxlength="4" required class="phone-input" placeholder="5678"
                oninput="handlePhoneInput(this)">
          <br>

          <label for="subject">ê³¼ëª©</label>
          <select id="subject" name="subject" required class="short-input" onchange="fetchLectures()">
            <option value="ì„ íƒ">ì„ íƒ</option>
          </select><br>

          <label for="lecture">ê°•ì˜</label>
          <select id="lecture" name="lecture" required class="wide-input">
              <option value="ì„ íƒ">ì„ íƒ</option>
          </select>

          <button type="button" onclick="addCourse()" class="addCourse-btn">ê°•ì˜ ì¶”ê°€</button><br>

          <fieldset class="course-cart">
              <legend>ì‹ ì²­ê°•ì˜</legend>
              <ul id="cart"></ul>
              <button type="button" onclick="clearCart()" class="clear-cart-btn">ì‹ ì²­ê°•ì˜ ë¹„ìš°ê¸°</button>
          </fieldset>

          <input type="submit" value="ì‹ ì²­í•˜ê¸°" style="margin-top: 15px;">
        </form>


        <form id="lookupForm" class="lookupForm" style="display: none;">
          <div class="lookupForm-content">
            <button type="button" class="close-btn" onclick="closelookupForm()">ë’¤ë¡œ ëŒì•„ê°€ê¸° âœ–</button>
            <h2>ğŸ“‹ ìˆ˜ê°•ì‹ ì²­ ë‚´ì—­ ì¡°íšŒ</h2>

            <div class="lookup-grid">
              <label for="lookupName">í•™ìƒëª…</label>
              <input type="text" id="lookupName" class="short-input" placeholder="ê¹€ë¸íƒ€">

              <label for="lookupGrade">í•™ë…„</label>
              <select id="lookupGrade" class="short-input">
                <option value="ì„ íƒ">ì„ íƒ</option>
                <option value="ì´ˆ6">ì˜ˆë¹„ì´ˆ6</option>
                <option value="ì¤‘1">ì˜ˆë¹„ì¤‘1</option>
                <option value="ì¤‘2">ì˜ˆë¹„ì¤‘2</option>
                <option value="ì¤‘3">ì˜ˆë¹„ì¤‘3</option>
                <option value="ê³ 1">ì˜ˆë¹„ê³ 1</option>
                <option value="ê³ 2">ì˜ˆë¹„ê³ 2</option>
                <option value="ê³ 3">ì˜ˆë¹„ê³ 3&Nìˆ˜</option>
                <option value="ì¼ê³¼ê³ ">ì¼ê³¼ê³ </option>
              </select>

              <label for="lookupParentContact">í•™ë¶€ëª¨ ì—°ë½ì²˜</label>
              <div class="phone-group">
                <input type="text" id="lookupParentContact1" maxlength="3" required class="phone-input" placeholder="010"
                  oninput="handlePhoneInput(this,'lookupParentContact2')">
                <span class="dash">-</span>
                <input type="text" id="lookupParentContact2" maxlength="4" required class="phone-input" placeholder="1234"
                  oninput="handlePhoneInput(this,'lookupParentContact3')">
                <span class="dash">-</span>
                <input type="text" id="lookupParentContact3" maxlength="4" required class="phone-input" placeholder="5678"
                  oninput="handlePhoneInput(this)">
              </div>
            </div>

            <button type="button" onclick="fetchSubmissionData()" class="search-btn">ì‹ ì²­ë‚´ì—­ ì¡°íšŒ</button>

            <div id="lookupResults" style="margin-top: 20px;"></div>

            <button id="change-btn" type="button" class="change-btn" style="display: none;" onclick="loadPreviousApplication()">ì‹ ì²­ë‚´ì—­ ë³€ê²½</button>
          </div>
        </form>



        <form id="checkRegist" class="checkRegist" style="display:none;">
          <div class="checkRegist-content">
            <h2>ğŸ“‹ìˆ˜ê°•ì‹ ì²­ ì™„ë£Œ!</h2>
            <p id="submit-message"></p>

            <div id="duplicateCourses" style="display:none; color:#d9534f; font-weight:600; margin:6px 0 12px 0;"></div>

            <div class="checkGrid">
              <label>í•™ìƒëª…</label><div class="value" id="checkName"></div>
              <label>í•™êµ/í•™ë…„</label><div class="value" id="checkGrade"></div>
              <label>í•™ìƒ ì—°ë½ì²˜</label><div class="value" id="checkStudentContact"></div>
              <label>í•™ë¶€ëª¨ ì—°ë½ì²˜</label><div class="value" id="checkParentContact"></div>
              <label>ì‹ ì²­ë‚´ì—­</label>
              <div class="value" id="checkLecture">
                <div id="newCoursesTitle" class="course-title" style="display:none;">ğŸ“˜ ì‹ ê·œ ì‹ ì²­ë‚´ì—­</div>
                <div id="newCourses"></div>

                <div id="previousCoursesTitle" class="course-title" style="display:none;">ğŸ“š ê¸°ì¡´ ì‹ ì²­ë‚´ì—­</div>
                <div id="previousCourses"></div>
              </div>
            </div>
            
            <div class="button-container" style="margin-top: 25px; text-align: center;">
              <button type="button" class="primary-btn" onclick="goToHome()">ğŸ  ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
              <button type="button" class="secondary-btn" style="margin-left: 10px;" onclick="goToAddMore()">â• ê°™ì€ ì •ë³´ë¡œ ì¶”ê°€ì‹ ì²­</button>
            </div>
          </div>
        </form>

      </div>

      <div id="selection" style="display: none;">
        <h2 id="selection-title"></h2>
        <p id="plzSelect-popup"></p><br>
        <button onclick="closeSelect()">ë‹«ê¸°</button>
      </div>

      <div id="loading" style="display: none;">
        <div class="loading-spinner"></div>
        <p class="loading-text">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
      </div>
      <script>
        const API_BASE = "https://script.google.com/macros/s/AKfycbym8kDFqCa8zJUx-CwqK7eG2Qhc0TqMrP4mJ5zL872mSLFR91LIWZFATeKkOo5_xYbk/exec";
      </script>
      <script src="script.js"></script>
    
    </body>
</html>
